---
title: "Gov 50 Final Project"
author: "Alia Al-Wir"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

I am interested in exploring data related to unemployment in the MENA region. I am particularly interested in exploring the trajectory of unemployment rates since the Arab Spring, since that was a driving factor in many countries. While some countries unemployment rates have dropped, others see even higher rates than before the protests and revolutions started. As such, I would be interested to see if there is a pattern between the effectiveness and changes that emerged post-Arab Spring, and unemployment rates. 

## Milestone 2

Do greater economic concerns and problems correlate to increased mistrust in the government, and how has this changed since the Arab Spring in the Arab states? I will explore how people's economic concerns have shifted in Arab countries and how this relates to how much they trust their government. I hypothesize that prior to the Arab Spring and in its early days, there were significant economic concerns and significant government mistrust. However, as the subsequent revolutions died down, economic apathy decreased and citizens' faith and and hope for their government increased until the pandemic where economic apathy and government mistrust returned. I will rely on data from the Arab Barometer Surveys (https://www.arabbarometer.org/survey-data/). They have seven data sets which consist of surveys conducted with citizens of Arab countries regarding all these factors, and their answers are given on a numerical scale of 1-4. 4 indicates less trust and 1 indicates more trust. The numbers 98 and 99 indicate people who did not know how to answer and refused to answer respectively. I will be able to examine the mean answers to specific questions regarding both economic and government apathy and trust, as well as calculate an overall mean response for these countries. I will also need to omit the 98 and 99 variables when calculating these means and instead calculate what proportion of people refused to give an answer. 
However, one issue I will face is that not all the Arab states were included in all the reports. The most recent report from 2021-2022 contains the largest number of Arab states surveyed at 12, while the first one conducted from 2006-2009 only examines seven states.

```{r}
load("data/ICPSR_35040/DS0001/35040-0001-Data.rda")

load("data/ICPSR_26581/DS0001/26581-0001-Data.rda")

load("data/ICPSR_36273/DS0001/36273-0001-Data.rda")

load("data/ICPSR_37029/DS0001/37029-0001-Data.rda")
```


## Milestone 3
```{r}
library(tidyverse)
```


```{r}
data_plot <- da35040.0001 |> 
  mutate(
    Q102 = case_when(Q102 == "(5) 5. much worse" ~ 5,
                      Q102 == "(4) 4. somewhat worse" ~ 4,
                      Q102 == "(3) 3. almost the same as the current situation" ~ 3,
                      Q102 == "(2) 2. somewhat better" ~ 2,
                      Q102 == "(1) 1. much better" ~ 1, 
                      TRUE ~ NA_real_),
    Countries = case_when(
      COUNTRY == "(1) 1. Algeria" ~ "Algeria", 
      COUNTRY == "(5) 5. Egypt" ~ "Egypt", 
      COUNTRY =="(7) 7. Iraq" ~ "Iraq",
      COUNTRY == "(17) 17. Saudi Arabia" ~ "Saudi Arabia", 
      COUNTRY == "(8) 8. Jordan" ~ "Jordan",
      COUNTRY == "(10) 10. Lebanon" ~ "Lebanon", 
      COUNTRY == "(15) 15. Palestine" ~ "Palestine", 
      COUNTRY == "(19) 19. Sudan" ~ "Sudan",
      COUNTRY == "(21) 21. Tunisia" ~ "Tunisia", 
      COUNTRY == "(22) 22. Yemen" ~ "Yemen"
    ))|>
    group_by(Countries)|>
    summarize(mean_Q102=mean(Q102,na.rm = T))
  
data_plot |>  
  ggplot(aes(y = mean_Q102, x = Countries))+
  geom_point()+
  labs(x = "Country", 
       y = "Mean of Economic Optimism 
       (1 being the most optimistic and 5 being the least optimistic)",
       title = "Mean of Economic Optimism over the Next 3-5 Years in Arab Countries",
       subtitle = "Source: Arab Barometer: Public Opinion Survey 2010-2011")+
  theme(axis.title.y = element_text(size = 8), 
        text = element_text(size = 8))
```

## Attempts at Milsetone 4
Actual answer is below
```{r, eval=FALSE}
data_06_09_econ <- da26581.0001|>
  mutate(
    Q102B = case_when(Q102 == "(5) much worse" ~ 5,
                      Q102 == "(4) a little worse" ~ 4,
                      Q102 == "(3) about the same" ~ 3,
                      Q102 == "(2) a little better" ~ 2,
                      Q102 == "(1) much better" ~ 1, 
                      TRUE ~ NA_real_),
    Countries = case_when(
      COUNTRY == "(1) jordan" ~ "Jordan", 
      COUNTRY == "(2) palestine" ~ "Palestine", 
      COUNTRY == "(3) algeria" ~ "Algeria", 
      COUNTRY =="(4) morocco" ~ "Morocco",
      COUNTRY == "(6) lebanon" ~ "Lebanon", 
      COUNTRY == "(7) yemen" ~ "Yemen",
      COUNTRY == "(8) bahrain" ~ "Bahrain"
    ))|>
    group_by(Countries)|>
    summarize(mean_Q102B=mean(Q102B,na.rm = T))
  
data_06_09_econ  |>  
  ggplot(aes(y = mean_Q102B, x = Countries))+
  geom_point()+
  labs(x = "Country", 
       y = "Mean of Economic Optimism 
       (1 being the most optimistic and 5 being the least optimistic)",
       title = "Mean of Economic Optimism over the Next 3-5 Years in Arab Countries",
       subtitle = "Source: Arab Barometer: Public Opinion Survey 2006-2009")+
  theme(axis.title.y = element_text(size = 8), 
        text = element_text(size = 8))

```




```{r, eval=FALSE}
data_06_09_trust <- da26581.0001|>
  mutate(
    Q2011A = case_when(Q2011 == "(1) a great deal of trust" ~ 1,
                      Q2011 == "(2) quite a lot of trust" ~ 2,
                      Q2011 == "(3) not very much trust" ~ 3,
                      Q2011 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2012A = case_when(Q2012 == "(1) a great deal of trust" ~ 1,
                      Q2012 == "(2) quite a lot of trust" ~ 2,
                      Q2012 == "(3) not very much trust" ~ 3,
                      Q2012 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2013A = case_when(Q2013 == "(1) a great deal of trust" ~ 1,
                      Q2013 == "(2) quite a lot of trust" ~ 2,
                      Q2013 == "(3) not very much trust" ~ 3,
                      Q2013 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2014A = case_when(Q2014 == "(1) a great deal of trust" ~ 1,
                      Q2014 == "(2) quite a lot of trust" ~ 2,
                      Q2014 == "(3) not very much trust" ~ 3,
                      Q2014 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2015A = case_when(Q2015 == "(1) a great deal of trust" ~ 1,
                      Q2015 == "(2) quite a lot of trust" ~ 2,
                      Q2015 == "(3) not very much trust" ~ 3,
                      Q2015 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
     Countries = case_when(
      COUNTRY == "(1) jordan" ~ "Jordan", 
      COUNTRY == "(2) palestine" ~ "Palestine", 
      COUNTRY == "(3) algeria" ~ "Algeria", 
      COUNTRY =="(4) morocco" ~ "Morocco",
      COUNTRY == "(6) lebanon" ~ "Lebanon", 
      COUNTRY == "(7) yemen" ~ "Yemen",
      COUNTRY == "(8) bahrain" ~ "Bahrain"))|>
    group_by(Countries)|>
    summarize(mean_Q2011A = mean(Q2011A,na.rm = T),
              mean_Q2012A = mean(Q2012A,na.rm = T),
              mean_Q2013A = mean(Q2013A,na.rm = T), 
              mean_Q2014A = mean(Q2014A,na.rm = T), 
              mean_Q2015A = mean(Q2015A,na.rm = T))|>
  mutate(mean_trust = mean_Q2011A + mean_Q2012A + mean_Q2013A + mean_Q2014A + mean_Q2015A)

data_06_09_trust|>
  ggplot(aes(y = mean_trust, x = Countries))+
  geom_point()+
  labs(x = "Country", 
       y = "Mean of Trust In Government Institutions  
       (1 being the most trust and 4 being the least trust)",
       title = "Mean of Trust in Government Institutions in Arab Countries",
       subtitle = "Source: Arab Barometer: Public Opinion Survey 2006-2009")+
  theme(axis.title.y = element_text(size = 8), 
        text = element_text(size = 8))


```


```{r, eval=FALSE}
data_06_09_trust & data_06_09_econ|>
  group_by(Countries)|>
  ggplot(aes(y = mean_trust, x = mean_Q102B))+
  geom_point()+
  labs(x = "Mean of Economic Optimism 
       (1 being the most optimistic and 5 being the least optimistic)", 
       y = "Mean of Trust In Government Institutions,  
       (1 being the most trust and 4 being the least trust)",
       title = "Trust in Government Institutions Against Economic Optimism",
       subtitle = "Source: Arab Barometer: Public Opinion Survey 2006-2009")
  
  
```


REGRESSION

```{r, eval=FALSE}
# TEMPLATE

regression.data <- da26581.0001|>
  mutate(
    Q2011A = case_when(Q2011 == "(1) a great deal of trust" ~ 1,
                      Q2011 == "(2) quite a lot of trust" ~ 2,
                      Q2011 == "(3) not very much trust" ~ 3,
                      Q2011 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2012A = case_when(Q2012 == "(1) a great deal of trust" ~ 1,
                      Q2012 == "(2) quite a lot of trust" ~ 2,
                      Q2012 == "(3) not very much trust" ~ 3,
                      Q2012 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2013A = case_when(Q2013 == "(1) a great deal of trust" ~ 1,
                      Q2013 == "(2) quite a lot of trust" ~ 2,
                      Q2013 == "(3) not very much trust" ~ 3,
                      Q2013 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2014A = case_when(Q2014 == "(1) a great deal of trust" ~ 1,
                      Q2014 == "(2) quite a lot of trust" ~ 2,
                      Q2014 == "(3) not very much trust" ~ 3,
                      Q2014 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2015A = case_when(Q2015 == "(1) a great deal of trust" ~ 1,
                      Q2015 == "(2) quite a lot of trust" ~ 2,
                      Q2015 == "(3) not very much trust" ~ 3,
                      Q2015 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
     Countries = case_when(
      COUNTRY == "(1) jordan" ~ "Jordan", 
      COUNTRY == "(2) palestine" ~ "Palestine", 
      COUNTRY == "(3) algeria" ~ "Algeria", 
      COUNTRY =="(4) morocco" ~ "Morocco",
      COUNTRY == "(6) lebanon" ~ "Lebanon", 
      COUNTRY == "(7) yemen" ~ "Yemen",
      COUNTRY == "(8) bahrain" ~ "Bahrain")) |>
  mutate(mean_trust=sum(Q2011A,Q2012A,Q2013A,Q2014A,Q2015A,na.rm=T))

fit1 <- lm(mean_trust ~ mean_Q102B, data=regression.data )
summary(fit1)
```
 
 KINDLY DISREGARD ALL PREVIOUS CODE :)

## ACTUAL Milestone 4

```{r}
first.regression <- da26581.0001|>
  mutate(
    Q2011A = case_when(Q2011 == "(1) a great deal of trust" ~ 1,
                      Q2011 == "(2) quite a lot of trust" ~ 2,
                      Q2011 == "(3) not very much trust" ~ 3,
                      Q2011 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2012A = case_when(Q2012 == "(1) a great deal of trust" ~ 1,
                      Q2012 == "(2) quite a lot of trust" ~ 2,
                      Q2012 == "(3) not very much trust" ~ 3,
                      Q2012 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2013A = case_when(Q2013 == "(1) a great deal of trust" ~ 1,
                      Q2013 == "(2) quite a lot of trust" ~ 2,
                      Q2013 == "(3) not very much trust" ~ 3,
                      Q2013 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2014A = case_when(Q2014 == "(1) a great deal of trust" ~ 1,
                      Q2014 == "(2) quite a lot of trust" ~ 2,
                      Q2014 == "(3) not very much trust" ~ 3,
                      Q2014 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
    Q2015A = case_when(Q2015 == "(1) a great deal of trust" ~ 1,
                      Q2015 == "(2) quite a lot of trust" ~ 2,
                      Q2015 == "(3) not very much trust" ~ 3,
                      Q2015 == "(4) none at all" ~ 4,
                      TRUE ~ NA_real_),
     Countries = case_when(
      COUNTRY == "(1) jordan" ~ "Jordan", 
      COUNTRY == "(2) palestine" ~ "Palestine", 
      COUNTRY == "(3) algeria" ~ "Algeria", 
      COUNTRY =="(4) morocco" ~ "Morocco",
      COUNTRY == "(6) lebanon" ~ "Lebanon", 
      COUNTRY == "(7) yemen" ~ "Yemen",
      COUNTRY == "(8) bahrain" ~ "Bahrain"),
    Q102B = case_when(Q102 == "(5) much worse" ~ 5,
                      Q102 == "(4) a little worse" ~ 4,
                      Q102 == "(3) about the same" ~ 3,
                      Q102 == "(2) a little better" ~ 2,
                      Q102 == "(1) much better" ~ 1, 
                      TRUE ~ NA_real_)) |>
  rename(economic_opporunity =  Q102B,
         Age = Q701AGECATEGORIES,
         Sex = Q702, 
         Education = Q703,
         Employment = Q704,
         Religion = Q711)

first.regression$mean_trust <- rowMeans(first.regression[,c('Q2011A','Q2012A','Q2013A','Q2014A','Q2015A')],na.rm = T)

first.regression|>
  #group_by(Countries)|>
  ggplot(aes(y = mean_trust, x = economic_opporunity))+
  geom_point()+
  geom_smooth(method = "lm")+
  labs(x = "Mean of Economic Optimism 
       (1 being the most optimistic and 5 being the least optimistic)", 
       y = "Mean of Trust In Government Institutions  
       (1 being the most trust and 4 being the least trust)",
       title = "Trust in Government Institutions Against Economic Optimism",
       subtitle = "Source: Arab Barometer: Public Opinion Survey 2006-2009")

fit1 <- lm(mean_trust ~ economic_opporunity + Age + Sex +Education + Religion + Employment, data = first.regression)
summary(fit1)

fit2 <- lm(mean_trust ~ economic_opporunity + Age + Sex +Education+factor(Countries), data = first.regression)
summary(fit2)
unique(first.regression$Countries)

#install.packages("texreg")
library(texreg)
screenreg(fit1)
screenreg(fit2)
```
The positive value of 0.19 as seen in the regression table suggests a positive relationship between trust in government institutions and economic optimism over the next 3-5 years in Arab countries according to survey data from 2006-2009. However, this does not take into account counterfactuals, where it could be trust in institutions that influences faith in economic opportunities or vice versa. 




